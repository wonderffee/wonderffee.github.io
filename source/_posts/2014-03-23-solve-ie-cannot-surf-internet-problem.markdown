---
layout: post
title: "解决IE不能上网问题小记"
date: 2014-03-23 17:22
comments: true
categories: 
---

虽然平常主要用Mac OS X，有时候还是不得不用XP来做一点事，却是总会遇到一些恼火的事情。比如，这一个周末的下午，都在纠缠IE不能上网，关机总是卡在“正在保存设置”，每次都得硬关机才行.

关于这个问题，我怀疑与一周前解决流氓hao123主页锁定问题有关。
<!--more-->

XP系统在一周前被hao123恶鬼上身，主页总是被锁定为hao123的某个推广账号的网址；

搜索注册表，把所有带hao123的注册项都修改为about:blank，重启还是老样子；

不得已，祭起360清理流氓插件，无果；用360锁定主页为空白页，重启过后还是无效；

打开360上的电脑专家，搜索“主页 hao123”，找到排在第一的“IE主页被篡改为hao123”解决方案，点立即修复，hao123主页锁定的问题就解决了。

估计就是从此落下了病根，这一周电脑启动都会出现打开IE不能上网，但是chrome却能打开网页，怀疑是杀hao123病毒将某些系统关键文件给误删了还是什么的。

用360修复过上网问题，重启是没问题了，但是再重启第二次问题依旧

甚至这个不能上网问题还能导致360卡死。。。

这个IE不能上网的问题我做了各种尝试，总结起来有以下几个现象：     
1. IE打不开网页，chrome上网却没有问题     
2. 在IE的Internet选项中打不开连接选项卡，一点就卡死，点关闭按钮IE闪退    
3. 桌面右下角系统托盘处的本地连接消失     
4. 桌面“网络邻居”右键点属性，鼠标指针显示忙碌，然后什么都没有打开     
5. 不能正常关机，关机时一直显示“正在保存设置”    
6. 不能远程

在网上搜索怀疑是Winsock劫持问题，尝试用过下面的方法，但是也是第一次重启是变正常了，IE上网和关机都好了，第二次重启问题却依旧。

>开始-运行-输入CMD-确定-输入netsh winsock reset，按Enter确定。然后重启。 如果提示需要管理员身份： 那是因为你没有管理员权限，win7系统打开C:\Windows\System32。 找到cmd.exe，右键以管理员运行就可以了，xp也是类似的方法

google了不知道多少遍都没找到一个此问题的标准答案。最后找到一个似乎解决问题的方法：重新安装TCP/IP协议，有一个简单的命令可以达到这样的效果：
```
netsh int ip reset c:resetlog.txt
```
执行了这个命令后，我试过重启三次托盘本地连接都能正常显示了，IE也能正常上网，但不排除是其它命令起了作用。 

浪费了一个宝贵的周末下午时间，我只能说，QNMD hao123，QNMD baidu

记录下在Windows中命令行设置DNS的命令：
```
netsh
int ip
set dns name="无线网络连接" source=static addr=114.114.114.114 register=PRIMARY
```